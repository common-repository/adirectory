!function(t){"use strict";var e,n,i,r,u,a,c,o,p,f,s,l,h,d,m,v,y,g,b,k,T,$,x,w,C,_,V,E,q=function(t){return t},L=function(e){return t.isArray(e)},A=function(t){return!L(t)&&t instanceof Object},O=function(e,n){return t.inArray(n,e)},j=function(t,e){for(var n in t)t.hasOwnProperty(n)&&e(t[n],n,t)},D=function(t){return t[t.length-1]},F=function(){var t,e={};return j((t=arguments,Array.prototype.slice.call(t)),function(t){j(t,function(t,n){e[n]=t})}),e},I=function(t,e){var n=[];return j(t,function(t,i,r){n.push(e(t,i,r))}),n},P=function(t,e,n){var i={};return j(t,function(t,r,u){i[r=n?n(r,t):r]=e(t,r,u)}),i},S=function(t,e,n){return L(t)?I(t,e):P(t,e,n)},U=function(t,e){var n;return L(t)?(n=[],j(t,function(t,i,r){e(t,i,r)&&n.push(t)})):(n={},j(t,function(t,i,r){e(t,i,r)&&(n[i]=t)})),n},z=function(t,e,n){return S(t,function(t,i){return t[e].apply(t,n||[])})},B=function(t){var e={};return(t=t||{}).publish=function(t,n){j(e[t],function(t){t(n)})},t.subscribe=function(t,n){e[t]=e[t]||[],e[t].push(n)},t.unsubscribe=function(t){j(e,function(e){var n=O(e,t);-1!==n&&e.splice(n,1)})},t};e=jQuery,n=function(t,e){var n,i=B(),r=t.$;return i.getType=function(){throw'implement me (return type. "text", "radio", etc.)'},i.$=function(t){return t?r.find(t):r},i.disable=function(){i.$().prop("disabled",!0),i.publish("isEnabled",!1)},i.enable=function(){i.$().prop("disabled",!1),i.publish("isEnabled",!0)},e.equalTo=function(t,e){return t===e},e.publishChange=function(t,r){var u=i.get();e.equalTo(u,n)||i.publish("change",{e:t,domElement:r}),n=u},i},i=function(t,e){var i=n(t,e);return i.get=function(){return i.$().val()},i.set=function(t){i.$().val(t)},i.clear=function(){i.set("")},e.buildSetter=function(t){return function(e){t.call(i,e)}},i},r=function(t){var e={},n=i(t,e);return n.getType=function(){return"text"},n.$().on("change keyup keydown",function(t){e.publishChange(t,this)}),n},u=function(t,e){t=L(t)?t:[t],e=L(e)?e:[e];var n=!0;return t.length!==e.length?n=!1:j(t,function(t){var i,r;i=e,-1!==O(i,r=t)||(n=!1)}),n},a=function(t){var e={},n=i(t,e);return n.getType=function(){return"button"},n.$().on("change",function(t){e.publishChange(t,this)}),n},c=function(t){var n={},r=i(t,n);return r.getType=function(){return"checkbox"},r.get=function(){var t=[];return r.$().filter(":checked").each(function(){t.push(e(this).val())}),t},r.set=function(t){t=L(t)?t:[t],r.$().each(function(){e(this).prop("checked",!1)}),j(t,function(t){r.$().filter('[value="'+t+'"]').prop("checked",!0)})},n.equalTo=u,r.$().change(function(t){n.publishChange(t,this)}),r},o=function(t){var e=r(t);return e.getType=function(){return"email"},e},p=function(t){var i={},r=n(t,i);return r.getType=function(){return"file"},r.get=function(){return D(r.$().val().split("\\"))},r.clear=function(){this.$().each(function(){e(this).wrap("<form>").closest("form").get(0).reset(),e(this).unwrap()})},r.$().change(function(t){i.publishChange(t,this)}),r},f=function(t){var e={},n=i(t,e);return n.getType=function(){return"hidden"},n.$().change(function(t){e.publishChange(t,this)}),n},s=function(t){var i={},r=n(t,i);return r.getType=function(){return"file[multiple]"},r.get=function(){var t,e=r.$().get(0).files||[],n=[];for(t=0;t<(e.length||0);t+=1)n.push(e[t].name);return n},r.clear=function(){this.$().each(function(){e(this).wrap("<form>").closest("form").get(0).reset(),e(this).unwrap()})},r.$().change(function(t){i.publishChange(t,this)}),r},l=function(t){var e={},n=i(t,e);return n.getType=function(){return"select[multiple]"},n.get=function(){return n.$().val()||[]},n.set=function(t){n.$().val(""===t?[]:L(t)?t:[t])},e.equalTo=u,n.$().change(function(t){e.publishChange(t,this)}),n},h=function(t){var e=r(t);return e.getType=function(){return"password"},e},d=function(t){var n={},r=i(t,n);return r.getType=function(){return"radio"},r.get=function(){return r.$().filter(":checked").val()||null},r.set=function(t){t?r.$().filter('[value="'+t+'"]').prop("checked",!0):r.$().each(function(){e(this).prop("checked",!1)})},r.$().change(function(t){n.publishChange(t,this)}),r},m=function(t){var e={},n=i(t,e);return n.getType=function(){return"range"},n.$().change(function(t){e.publishChange(t,this)}),n},v=function(t){var e={},n=i(t,e);return n.getType=function(){return"select"},n.$().change(function(t){e.publishChange(t,this)}),n},y=function(t){var e={},n=i(t,e);return n.getType=function(){return"textarea"},n.$().on("change keyup keydown",function(t){e.publishChange(t,this)}),n},g=function(t){var e=r(t);return e.getType=function(){return"url"},e},b=function(t){var e=r(t);return e.getType=function(){return"color"},e},k=function(t){var e=r(t);return e.getType=function(){return"date"},e},T=function(t){var e=r(t);return e.getType=function(){return"datetime-local"},e},$=function(t){var e=r(t);return e.getType=function(){return"month"},e},x=function(t){var e=r(t);return e.getType=function(){return"number"},e},w=function(t){var e=r(t);return e.getType=function(){return"search"},e},C=function(t){var e=r(t);return e.getType=function(){return"tel"},e},_=function(t){var e=r(t);return e.getType=function(){return"time"},e},V=function(t){var e=r(t);return e.getType=function(){return"week"},e},E=function(t){var n={},i=t.$,u=t.constructorOverride||{color:b,date:k,datetimeLocal:T,month:$,number:x,search:w,tel:C,time:_,week:V,button:a,text:r,url:g,email:o,password:h,range:m,textarea:y,select:v,"select[multiple]":l,radio:d,checkbox:c,file:p,"file[multiple]":s,hidden:f},E=function(t,r){(A(r)?r:i.find(r)).each(function(){n[e(this).attr("name")]=u[t]({$:e(this)})})},q=function(t,r){var a=[],c=A(r)?r:i.find(r);A(r)?n[c.attr("name")]=u[t]({$:c}):(c.each(function(){-1===O(a,e(this).attr("name"))&&a.push(e(this).attr("name"))}),j(a,function(e){n[e]=u[t]({$:i.find('input[name="'+e+'"]')})}))};return i.is("input, select, textarea")?i.is('input[type="button"], button, input[type="submit"]')?E("button",i):i.is("textarea")?E("textarea",i):i.is('input[type="text"]')||i.is("input")&&!i.attr("type")?E("text",i):i.is('input[type="password"]')?E("password",i):i.is('input[type="email"]')?E("email",i):i.is('input[type="url"]')?E("url",i):i.is('input[type="color"]')?E("color",i):i.is('input[type="date"]')?E("date",i):i.is('input[type="datetime-local"]')?E("datetimeLocal",i):i.is('input[type="month"]')?E("month",i):i.is('input[type="number"]')?E("number",i):i.is('input[type="search"]')?E("search",i):i.is('input[type="tel"]')?E("tel",i):i.is('input[type="time"]')?E("time",i):i.is('input[type="week"]')?E("week",i):i.is('input[type="range"]')?E("range",i):i.is("select")?E(i.is("[multiple]")?"select[multiple]":"select",i):i.is('input[type="file"]')?E(i.is("[multiple]")?"file[multiple]":"file",i):i.is('input[type="hidden"]')?E("hidden",i):i.is('input[type="radio"]')?q("radio",i):i.is('input[type="checkbox"]')?q("checkbox",i):E("text",i):(E("button",'input[type="button"], button, input[type="submit"]'),E("text",'input[type="text"]'),E("color",'input[type="color"]'),E("date",'input[type="date"]'),E("datetimeLocal",'input[type="datetime-local"]'),E("month",'input[type="month"]'),E("number",'input[type="number"]'),E("search",'input[type="search"]'),E("tel",'input[type="tel"]'),E("time",'input[type="time"]'),E("week",'input[type="week"]'),E("password",'input[type="password"]'),E("email",'input[type="email"]'),E("url",'input[type="url"]'),E("range",'input[type="range"]'),E("textarea","textarea"),E("select","select:not([multiple])"),E("select[multiple]","select[multiple]"),E("file",'input[type="file"]:not([multiple])'),E("file[multiple]",'input[type="file"][multiple]'),E("hidden",'input[type="hidden"]'),q("radio",'input[type="radio"]'),q("checkbox",'input[type="checkbox"]')),n},e.fn.inputVal=function(t){var n=e(this),i=E({$:n});return n.is("input, textarea, select")?void 0===t?i[n.attr("name")].get():(i[n.attr("name")].set(t),n):void 0===t?z(i,"get"):(j(t,function(t,e){i[e].set(t)}),n)},e.fn.inputOnChange=function(t){var n=e(this),i=E({$:n});return j(i,function(e){e.subscribe("change",function(e){t.call(e.domElement,e.e)})}),n},e.fn.inputDisable=function(){var t=e(this);return z(E({$:t}),"disable"),t},e.fn.inputEnable=function(){var t=e(this);return z(E({$:t}),"enable"),t},e.fn.inputClear=function(){var t=e(this);return z(E({$:t}),"clear"),t},t.fn.repeaterVal=function(){var e,n,i=function(t){if(1===t.length&&(0===t[0].key.length||1===t[0].key.length&&!t[0].key[0]))return t[0].val;j(t,function(t){t.head=t.key.shift()});var e,n,r=(e={},j(t,function(t){e[t.head]||(e[t.head]=[]),e[t.head].push(t)}),e);return/^[0-9]+$/.test(t[0].head)?(n=[],j(r,function(t){n.push(i(t))})):(n={},j(r,function(t,e){n[e]=i(t)})),n};return i((e=t(this).inputVal(),n=[],j(e,function(t,e){var i=[];"undefined"!==e&&(i.push(e.match(/^[^\[]*/)[0]),i=i.concat(S(e.match(/\[[^\]]*\]/g),function(t){return t.replace(/[\[\]]/g,"")})),n.push({val:t,key:i}))}),n))},t.fn.repeater=function(e){var n;return e=e||{},t(this).each(function(){var i=t(this),r=e.show||function(){t(this).show()},u=e.hide||function(t){t()},a=i.find("[data-repeater-list]").first(),c=function(e,n){return e.filter(function(){var e;return!n||0===t(this).closest(S(e=n,function(t){return t.selector}).join(",")).length})},o=function(){return c(a.find("[data-repeater-item]"),e.repeaters)},p=a.find("[data-repeater-item]").first().clone().hide(),f=c(c(t(this).find("[data-repeater-item]"),e.repeaters).first().find("[data-repeater-delete]"),e.repeaters);e.isFirstItemUndeletable&&f&&f.remove();var s,l=function(){var t=a.data("repeater-list");return e.$parent?e.$parent.data("item-name")+"["+t+"]":t},h=function(n){e.repeaters&&n.each(function(){var n=t(this);j(e.repeaters,function(t){n.find(t.selector).repeater(F(t,{$parent:n}))})})},d=function(t,e,n){t&&j(t,function(t){n.call(e.find(t.selector)[0],t)})},m=function(e,n,i){e.each(function(e){var r=t(this);r.data("item-name",n+"["+e+"]"),c(r.find("[name]"),i).each(function(){var u,a=t(this),o=a.attr("name").match(/\[[^\]]+\]/g),p=n+"["+e+"]["+(o?D(o).replace(/\[|\]/g,""):a.attr("name"))+"]"+(a.is(":checkbox")||a.attr("multiple")?"[]":"");a.attr("name",p),d(i,r,function(i){var r=t(this);m(c(r.find("[data-repeater-item]"),i.repeaters||[]),n+"["+e+"]["+r.find("[data-repeater-list]").first().data("repeater-list")+"]",i.repeaters)})})}),a.find("input[name][checked]").removeAttr("checked").prop("checked",!0)};m(o(),l(),e.repeaters),h(o()),e.initEmpty&&o().remove(),e.ready&&e.ready(function(){m(o(),l(),e.repeaters)});var v=(s=function(n,i,r){if(i||e.defaultValues){var u={};c(n.find("[name]"),r).each(function(){u[t(this).attr("name").match(/\[([^\]]*)(\]|\]\[\])$/)[1]]=t(this).attr("name")}),n.inputVal(S(U(i||e.defaultValues,function(t,e){return u[e]}),q,function(t){return u[t]}))}d(r,n,function(e){var n=t(this);c(n.find("[data-repeater-item]"),e.repeaters).each(function(){var r=n.find("[data-repeater-list]").data("repeater-list");if(i&&i[r]){var u=t(this).clone();n.find("[data-repeater-item]").remove(),j(i[r],function(t){var i=u.clone();s(i,t,e.repeaters||[]),n.find("[data-repeater-list]").append(i)})}else s(t(this),e.defaultValues,e.repeaters||[])})})},function(n,i){a.append(n),m(o(),l(),e.repeaters),n.find("[name]").each(function(){t(this).inputClear()}),s(n,i||e.defaultValues,e.repeaters)}),y=function(t){var n=p.clone();v(n,t),e.repeaters&&h(n),r.call(n.get(0))};n=function(t){o().remove(),j(t,y)},c(i.find("[data-repeater-create]"),e.repeaters).click(function(){y()}),a.on("click","[data-repeater-delete]",function(){var n=t(this).closest("[data-repeater-item]").get(0);u.call(n,function(){t(n).remove(),m(o(),l(),e.repeaters)})})}),this.setList=n,this}}(jQuery);
